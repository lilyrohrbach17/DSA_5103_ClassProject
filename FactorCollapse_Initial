#Factor Collapsing
train$job<-fct_collapse(train$job,
                        Accountant=c("Accountant, chartered public finance", "Chartered public finance accountant",
                                     "Accountant, chartered certified", "Chartered accountant", "Accountant, chartered"),
                        Therapist=c("Dance movement psychotherapist","Therapist, occupational", "Physiotherapist",
                                    "Child psychotherapist", "Therapist, horticultural", "Therapist, sports", 
                                    "Therapist, occupational", "Phytotherapist", "Psychotherapist, child", "Physiotherapist", 
                                    "Art therapist", "Music therapist", "Occupational therapist", "Therapist, sports",
                                    "Horticultural therapist", "Therapist, drama", "Therapist, art", "Nutritional therapist","Psychotherapist",
                                    "Therapist, music"),
                        Psychologist=c("Psychologist, counselling","Forensic psychologist","Psychologist, forensic", 
                                       "Educational psychologist", "Counselling psychologist", "Occupational psychologist", 
                                       "Psychologist, sport and exercise", "Clinical psychologist", "Psychologist, clinical", 
                                       "Sport and exercise psychologist","Psychiatrist"),
                        Administrator=c("Administrator, education","Administrator, charities/voluntary organisations", 
                                        "Database administrator", "Administrator", "Administrator, local government", 
                                        "Secretary/administrator", "Education administrator" , "Civil Service administrator", 
                                        "Sports administrator", "Administrator, arts"),
                        Designer = c("Designer, multimedia", "Designer, jewellery", "Product designer", 
                                     "Exhibition designer", "Designer, ceramics/pottery", 
                                     "Designer, interior/spatial", "Jewellery designer", 
                                     "Designer, industrial/product", "Industrial/product designer", 
                                     "Ceramics designer",  "Web designer", "Designer, furniture",
                                     "Furniture designer", "Interior and spatial designer", 
                                     "Designer, exhibition/display", "Textile designer", 
                                     "Designer, television/film set", "Designer, textile", 
                                     "Glass blower/designer"), 
                        Engineer = c("Engineer, land", "Energy engineer", 'Network engineer', 
                                     "Building services engineer", "Electrical engineer", "Engineer, technical sales", 
                                     "Engineer, electronics", "Water engineer", "Geologist, engineering", 
                                     "Engineer, broadcasting (operations)", "Engineer, biomedical", 
                                     "Engineering geologist", "Mining engineer", "Engineer, communications", 
                                     "Materials engineer", "Engineer, structural", "Structural engineer", 
                                     "Mechanical engineer", "Electronics engineer", "Chemical engineer", 
                                     "Engineer, building services", "Engineer, mining", "Control and instrumentation engineer", 
                                     "Engineer, control and instrumentation", "Engineer, maintenance", 
                                     "Engineer, production", "Manufacturing engineer", "Production engineer", 
                                     "Engineer, drilling", "Engineer, petroleum", "Civil engineer, contracting", 
                                     "Engineer, agricultural", "Engineer, manufacturing", "Engineer, automotive", 
                                     "Site engineer", "Manufacturing systems engineer", "Petroleum engineer","Maintenance engineer",
                                     "Aeronautical engineer","Drilling engineer","Biomedical engineer","Engineer, aueronautical",
                                     "Engineerm civil (consulting)"), 
                        Scientist = c("Scientist, research (maths)", "Product/process development scientist", 
                                      "Research scientist (physical sciences)", "Audiological scientist", 
                                      "Scientist, audiological", "Physiological scientist", "Scientist, marine", 
                                      "Research scientist (life sciences)", "Water quality scientist", 
                                      "Scientist, physiological", "Scientist, biomedical", "Geoscientist", 
                                      "Soil scientist", "Data scientist", "Scientist, research (medical)", 
                                      "Scientist, clinical (histocompatibility and immunogenetics)", 
                                      "Research scientist (medical)","Geochemist","Archaeologist","Scientific laboratory technician",
                                      "Statistician","Biochemist, clinical", "Biomedical scientist","Chemist, analytical","Geneticist, molecular"), 
                        Consultant = c("Pensions consultant","Agricultural consultant","Financial adviser","Environmental consultant"),
                        Medical = c("Podiatrist","Cytogeneticist","Mental health nurse","Occupational hygienist","Surgeon", "Toxicologist",
                                    "Immunologist","Learning disability nurse","Nurse, children's","Pharmacist, community","Medical technical officer",
                                    "Nurse, mental health","Hospital doctor","Neurosurgeon","Optician, dispensing","Paediatric nurse",
                                    "Doctor, general practice", "Doctor, hospital","Embryologist, clinical","Optometrist","Orthoptist",
                                    "Pharmacist, hospital","Pharmacologist"),
                        Law = c("Barrister","Barrister's clerk","Lawyer"),
                        Other = c("Insurance underwriter","Naval architect","Dispensing optician",
                                  "Historic buildings inspector/conservation officer"),
                        Teacher = c("Special educational needs teacher", "English as a second language teacher", 
                                    "Teacher, English as a foreign language", "Teacher, early years/pre", 
                                    "Primary school teacher", "Secondary school teacher", "Teacher, secondary school", 
                                    "Teacher, special educational needs", "Early years teacher", "Private music teacher", 
                                    "Teacher, primary school", "TEFL teacher", "Teacher, adult education","Sub"))

#Train Factor Collapse
p<-fct_count(train$job, sort=TRUE)
train<-train%>%mutate(job=fct_lump_n(job,n=11))
p<-fct_count(train$job, sort=TRUE)
p %>% print(n = 12)

#Test Factor Collapse
q<-fct_count(test$job, sort=TRUE)
q %>% print(n = 300)

test$job<-fct_collapse(test$job,
                       Accountant=c(),
                       Therapist=c("Physiotherapist","Therapist, occupational","Child psychotherapist", "Therapist, drama",
                                   "Psychotherapist","Psychotherapist, child","Therapist, sports","Dance movement psychotherapist",
                                   "Nutritional therapist"),
                       Psychologist=c("Forensic psychologist","Psychologist, forensic","Counselling psychologist",
                                      "Educational psychologist","Psychologist, clinical","Occupational psychologist",
                                      "Psychologist, counselling","Psychologist, sport and exercise"),
                       Administrator=c("Administrator","Administrator, local government"),
                       Designer = c("Ceramics designer","Exhibition designer","Product designer","Designer, furniture",
                                    "Designer, ceramics/pottery","Designer, industrial/product","Designer, jewellery",
                                    "Glass blower/designer"), 
                       Engineer = c("Electrical engineer","Energy engineer","Engineering geologist","Maintenance engineer",
                                    "Mechanical engineer","Chemical engineer","Drilling engineer","Engineer, production",
                                    "Materials engineer","Structural engineer","Engineer, civil (contracting)","Engineer, control and instrumentation",
                                    "Engineer, land","Site engineer","Aeronautical engineer","Biomedical engineer",
                                    "Building services engineer","Civil engineer, contracting","Communications engineer",
                                    "Engineer, automotive","Engineer, biomedical","Engineer, broadcasting (operations)",
                                    "Engineer, electronics","Engineer, maintenance","Geologist, engineering","Petroleum engineer",
                                    "Water engineer"), 
                       Scientist = c("Clinical biochemist","Operations geologist","Scientist, audiological",
                                     "Scientist, marine","Scientist, research (maths)","Special educational needs teacher",
                                     "Audiological scientist","Soil scientist","Analytical chemist","Biomedical scientist",
                                     "Geneticist, molecular"),
                       Consultant = c("Financial adviser","Pensions consultant","Health and safety adviser","Environmental consultant"),
                       Medical = c("Chiropodist","Podiatrist","General practice doctor","Immunologist",
                                   "Optometrist","Doctor, hospital","Mental health nurse","Neurosurgeon","Surgeon","Community pharmacist",
                                  "Dispensing optician","Embryologist, clinical","Doctor, general practice","Occupational hygienist",
                                  "Paediatric nurse"),
                       Law = c("Barrister's clerk","Patent attorney"),
                       Teacher = c("Secondary school teacher","Lecturer, further education","Private music teacher",
                                   "Early years teacher","Sub","Teacher, secondary school","Teacher, special educational needs",
                                   "Lecturer, higher education","Professor Ermitus","Teacher, early years/pre",
                                   "English as a second language teacher"))

test<-test%>%mutate(job=fct_lump_n(job,n=10))
p<-fct_count(test$job, sort=TRUE)
p %>% print(n = 11)
